!function(t,e){let n=null,i=null,o=null,l=null,s=null,a=null,h=0,c=0,u=0,d=null,p=null,r="current",f=null,m=null,v=null,g=null,x=null,$=0,w=0,y=[],z=null,I=null,W=null,_=null,H=null,M=null,P=0,b=0,B=0,k=0,q={},N={navWidth:60,navHeight:60,navItemNum:5,navItemMargin:7,navBorder:1,autoPlay:!0,autoPlayTimeout:2e3},T={init:function(T){var D;let F=t.extend({},N,T),G;n=this,i=n.find(".exzoom_img_box"),a=n.find(".exzoom_img_ul"),d=n.find(".exzoom_nav"),g=n.find(".exzoom_prev_btn"),x=n.find(".exzoom_next_btn"),l=o=n.outerWidth(),q.navWidth=F.navWidth,q.navHeight=F.navHeight,q.navBorder=F.navBorder,q.navItemMargin=F.navItemMargin,q.navItemNum=F.navItemNum,q.autoPlay=F.autoPlay,q.autoPlayTimeout=F.autoPlayTimeout,$=(v=i.find("img")).length,D=v,G=setInterval(function(){let N=0,T=D.length;D.each(function(){this.complete&&N++}),N===T&&(clearInterval(G),function N(){i.append("<div class='exzoom_img_ul_outer'></div>"),d.append("<p class='exzoom_nav_inner'></p>"),s=i.find(".exzoom_img_ul_outer"),p=d.find(".exzoom_nav_inner"),s.append(a);for(let T=0;T<$;T++){y[T]=E(v.eq(T));let D=a.find("li").eq(T);D.css("width",o),D.find("img").css({"margin-top":y[T][5],width:y[T][3]})}f=d.find("span"),m=2*q.navBorder+q.navHeight,q.exzoom_navWidth=(m+q.navItemMargin)*q.navItemNum,q.exzoom_nav_innerWidth=(m+q.navItemMargin)*$,f.eq(w).addClass(r),d.css({height:m+"px",width:o-g.width()-x.width()}),p.css({width:q.exzoom_nav_innerWidth+"px"}),f.css({"margin-left":q.navItemMargin+"px",width:q.navWidth+"px",height:q.navHeight+"px"}),c=o*$,u=o*($-1),a.css("width",c),i.append(`
<div class='exzoom_zoom_outer'>
    <span class='exzoom_zoom'></span>
</div>
<p class='exzoom_preview'>
    <img class='exzoom_preview_img' src='' />
</p>
            `),z=i.find(".exzoom_zoom"),I=i.find(".exzoom_main_img"),W=i.find(".exzoom_zoom_outer"),_=i.find(".exzoom_preview"),H=i.find(".exzoom_preview_img"),i.css({width:l+"px",height:l+"px"}),s.css({width:l+"px",height:l+"px"}),_.css({width:l+"px",height:l+"px",left:l+5+"px"}),A(y[w]),S(),a.on("touchstart",function(t){let n=j(t);P=n.x,b=n.y;h=parseInt(a.css("left")),e.clearInterval(M)}),a.on("touchmove",function(t){let e=j(t),n;B=e.x,k=e.y,n=C(n=h+B-P),a.css("left",n)}),a.on("touchend",function(t){console.log(B<P),B<P?Y():B>P&&Q(),S()}),W.on("mousedown",function(t){let e=j(t);P=e.x,b=e.y;h=parseInt(a.css("left"))}),W.on("mouseup",function(t){let e=n.offset();P-e.left<o/2?Q():P-e.left>o/2&&Y()}),n.on("mouseenter",function(){e.clearInterval(M)}),n.on("mouseleave",function(){S()}),W.on("mouseenter",function(){z.css("display","block"),_.css("display","block")}),W.on("mousemove",function(t){let e=z.width()/2,n=W.width()-e,i=W.height()-e,o=t.pageX-W.offset().left,l=t.pageY-W.offset().top,s=o-e,a=l-e;o<=e&&(s=0),o>=n&&(s=n-e),l<=e&&(a=0),l>=i&&(a=i-e),z.css({left:s+"px",top:a+"px"}),H.css({left:-s*_.width()/z.width()+"px",top:-a*_.width()/z.width()+"px"})}),W.on("mouseleave",function(){z.css("display","none"),_.css("display","none")}),_.on("mouseenter",function(){z.css("display","none"),_.css("display","none")}),x.on("click",function(){Y()}),g.on("click",function(){Q()}),f.hover(function(){X(w=t(this).index())})}())},100)},prev:function(){Q()},next:function(){Y()},setImg:function(){let t=arguments[0];D(t,function(e,n){H.attr("src",t),I.attr("src",t),a.find("li").length===$+1&&a.find("li:last").remove(),a.append('<li style="width: '+o+'px;"><img src="'+t+'"></li>');let i=E(t,e,n);A(i)})}};function j(t){let n=t||e.event,i=n,o,l;return void 0!==n.touches&&n.touches.length>0&&(i=n.touches[0]),{x:o=i.clientX||i.pageX,y:l=i.clientY||i.pageY}}function C(t){return-t>u?(t=-u,w=0):t>0&&(t=0),t}function X(t){void 0===t&&alert("exzoom 中的 move 函数的 direction 参数必填"),w>y.length-1&&(w=0),f.eq(w).addClass(r).siblings().removeClass(r);let e=d.width(),n=q.navItemMargin+q.navWidth+2*q.navBorder,i=0,l=n*(w+1);l>e&&(i=o-l),p.css({left:i});let s=-o*w;s=C(s),a.stop().animate({left:s},500),A(y[w])}function Y(){++w>$&&(w=$),X("right")}function Q(){--w<0&&(w=0),X("left")}function S(){q.autoPlay&&(M=e.setInterval(function(){w>=$&&(w=0),w++,X("right")},q.autoPlayTimeout))}function A(t){void 0!==t&&(H.attr("src",t[0]),I.attr("src",t[0]).css({width:t[3]+"px",height:t[4]+"px"}),W.css({width:t[3]+"px",height:t[4]+"px",top:t[5]+"px",left:t[6]+"px",position:"relative"}),z.css({width:t[7]+"px",height:t[7]+"px"}),H.css({width:t[8]+"px",height:t[9]+"px"}))}function D(t,e){let n=new Image;if(n.src=t,void 0===e)return{width:n.width,height:n.height};n.complete?e(n.width,n.height):n.onload=function(){e(n.width,n.height)}}function E(t,e,n){let i,o=[];if("string"==typeof t)i=t;else{let s=D(i=t.attr("src"));e=s.width,n=s.height}o[0]=i,o[1]=e,o[2]=n;let a=o[1]/o[2];if(1===a)o[3]=l,o[4]=l,o[5]=0,o[6]=0,o[7]=l/2,o[8]=2*l,o[9]=2*l,p.append(`<span><img src="${i}" width="${q.navWidth}" height="${q.navHeight}"/></span>`);else if(a>1){o[3]=l,o[4]=l/a,o[5]=(l-o[4])/2,o[6]=0,o[7]=o[4]/2,o[8]=2*l*a,o[9]=2*l;let h=(q.navHeight-q.navWidth/a)/2;p.append(`<span><img src="${i}" width="${q.navWidth}" style='top:${h}px;' /></span>`)}else if(a<1){o[3]=l*a,o[4]=l,o[5]=0,o[6]=(l-o[3])/2,o[7]=o[3]/2,o[8]=2*l,o[9]=2*l/a;let c=(q.navWidth-q.navHeight*a)/2;p.append(`<span><img src="${i}" height="${q.navHeight}" style="left:${c}px;"/></span>`)}return o}t.fn.extend({exzoom:function(e,n){if(0!==arguments.length&&("object"!=typeof e||n)){if(T[e])return T[e].apply(this,Array.prototype.slice.call(arguments,1));t.error("Method "+e+"does not exist on jQuery.exzomm")}else{if(0!==this.length)return T.init.apply(this,arguments);t.error("Selector is empty when call jQuery.exzomm")}}})}(jQuery,window);
